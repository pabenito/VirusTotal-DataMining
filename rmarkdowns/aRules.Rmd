---
title: "Virustotal_aRules"
author: "√Ångel Sergio"
date: '2022-05-18'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r librerias}
library(dplyr)
library(arules)
library(magrittr)
library(rmarkdown)
```


```{r lectura, include=FALSE}
virus <- read.csv('data/virusTotal.csv')
virus$additional_info.androguard.RiskIndicator.PERM.SIGNATURE

```

```{r lectura, include=FALSE}
rules <- virus %>%
   select(c(additional_info.androguard.RiskIndicator.PERM.DANGEROUS,
             additional_info.androguard.RiskIndicator.PERM.GPS,
             additional_info.androguard.RiskIndicator.PERM.NORMAL,
             additional_info.androguard.RiskIndicator.PERM.PRIVACY,
             additional_info.androguard.RiskIndicator.PERM.INTERNET,
             additional_info.androguard.RiskIndicator.PERM.INSTANT,
             additional_info.androguard.RiskIndicator.PERM.SMS,
             additional_info.androguard.RiskIndicator.PERM.MONEY,
             additional_info.androguard.RiskIndicator.PERM.SYSTEM,
             additional_info.androguard.RiskIndicator.PERM.CALL,
             additional_info.androguard.RiskIndicator.PERM.SIGNATURE,
             additional_info.androguard.RiskIndicator.PERM.DEVELOPMENT,
             additional_info.androguard.RiskIndicator.PERM.PRE23,
             additional_info.androguard.RiskIndicator.PERM.APPOP,
             additional_info.androguard.RiskIndicator.PERM.EPHEMERAL,
             additional_info.androguard.RiskIndicator.PERM.PREINSTALLED,
             additional_info.androguard.RiskIndicator.PERM.INSTALLER,
             additional_info.androguard.RiskIndicator.PERM.RUNTIME
             ))
View(rules)



df <- discretizeDF(iris,method=list("DANGEROUS"=list(method="frequency",
                                  breaks=3,labels=c("small","medium","large")),
                                        "Sepal.Width"=list(method="frequency",
                                  breaks=3,labels=c("small","medium","large")),
                                        "Petal.Length"=list(method="frequency",
                                  breaks=3,labels=c("small","medium","large")),
                                        "Petal.Width"=list(method="frequency",
                                  breaks=3,labels=c("small","medium","large"))),
                                        default=list(method="none"))

```



```{r}
r1 <- apriori(df_2, parameter = list(supp=0.01, conf=0.5))
inspect(r1)
```